{% extends "base.html" %}
{% block content %}
<div class="min-h-[60vh] flex items-center justify-center">
  <div class="bg-white border border-red-300 rounded p-8 shadow w-full max-w-2xl">
    <h1 class="text-2xl font-bold text-red-700 mb-6 text-center">แก้ไขโปรไฟล์</h1>

    {% if messages %}
      <div class="space-y-2 mb-4">
        {% for m in messages %}
          <div class="px-4 py-2 rounded border
            {% if m.tags == 'error' %} bg-red-100 border-red-400 text-red-700
            {% elif m.tags == 'success' %} bg-green-100 border-green-400 text-green-700
            {% else %} bg-gray-100 border-gray-300 text-gray-800 {% endif %}">
            {{ m }}
          </div>
        {% endfor %}
      </div>
    {% endif %}

    <form method="post" enctype="multipart/form-data" class="space-y-6" autocomplete="off">
      {% csrf_token %}

      <!-- ข้อมูล User (ใช้ uform) -->
      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <div class="md:col-span-2">
          <label class="block mb-2">ชื่อผู้ใช้ (Username)</label>
          {{ uform.username }}
          {% if uform.username.errors %}
            <p class="mt-1 text-sm text-red-600">{{ uform.username.errors.0 }}</p>
          {% endif %}
        </div>

        <div>
          <label class="block mb-2">ชื่อ</label>
          {{ uform.first_name }}
          {% if uform.first_name.errors %}
            <p class="mt-1 text-sm text-red-600">{{ uform.first_name.errors.0 }}</p>
          {% endif %}
        </div>

        <div>
          <label class="block mb-2">นามสกุล</label>
          {{ uform.last_name }}
          {% if uform.last_name.errors %}
            <p class="mt-1 text-sm text-red-600">{{ uform.last_name.errors.0 }}</p>
          {% endif %}
        </div>

        <div class="md:col-span-2">
          <label class="block mb-2">อีเมล</label>
          {{ uform.email }}
          {% if uform.email.errors %}
            <p class="mt-1 text-sm text-red-600">{{ uform.email.errors.0 }}</p>
          {% endif %}
        </div>
      </div>

      <!-- ข้อมูล Profile (ใช้ ProfileForm ผ่านตัวแปร form) -->
      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <div class="md:col-span-2">
          <label class="block mb-2">ชื่อ-นามสกุล</label>
          {{ form.full_name }}
          {% if form.full_name.errors %}
            <p class="mt-1 text-sm text-red-600">{{ form.full_name.errors.0 }}</p>
          {% endif %}
        </div>

        <div>
          <label class="block mb-2">เบอร์โทร</label>
          {{ form.phone }}
          {% if form.phone.errors %}
            <p class="mt-1 text-sm text-red-600">{{ form.phone.errors.0 }}</p>
          {% endif %}
        </div>

        <div class="md:col-span-2">
          <label class="block mb-2">ที่อยู่</label>
          {{ form.address }}
          {% if form.address.errors %}
            <p class="mt-1 text-sm text-red-600">{{ form.address.errors.0 }}</p>
          {% endif %}
        </div>

        <div class="md:col-span-2">
          <label class="block mb-2">รูปโปรไฟล์</label>
          {{ form.image }}
          {% if profile.image %}
            <img src="{{ profile.image.url }}" class="mt-3 w-24 h-24 rounded-full object-cover border border-red-300" alt="avatar">
          {% endif %}
          {% if form.image.errors %}
            <p class="mt-1 text-sm text-red-600">{{ form.image.errors.0 }}</p>
          {% endif %}
        </div>
      </div>

      <div class="flex gap-3">
        <button class="bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded">บันทึก</button>
        <a href="{% url 'profile' %}" class="bg-white border border-red-500 text-red-600 px-4 py-2 rounded hover:bg-red-50">ยกเลิก</a>
      </div>
    </form>
  </div>
</div>
{% endblock %}
